# Coordinate-transformation-of-control-network
# 控制场基准点程序readme
程序设计背景：
本程序是为实验室设计的V-STARS-影像仪结合的wMPS发射站内参快速标定方法设计的转站程序。控制场的整个设计，一是为了提高发射站内参标定的效率，二是为了避免原“激光跟踪仪-球形接收器”系统作为标定基准时的得到的标定点（即球形接收器的球心）与实际光电接受元件的中心存在的偏心误差。
新控制场采用VSTARS系统进行控制场坐标系的建立，这一步对测试效率有一定的提高。再结合影像仪系统测得光敏元件中心与靶标上VSTRAS靶点的相对位置关系，通过坐标转换，得到光敏元件的中心点在VSTARS坐标系下的坐标，并将其作为发射站内参标定的基准点。

程序功能：由前期已经获得的坐标数据和靶标间关系来获得控制场的基准点坐标。简单来说本程序解决了光敏元件中心无法再V-STARS系统中被检测到的问题，转而用相对位置关系获得光敏元件中心在V-STARS系统下的三维坐标。

主程序输入：
1.	V-STARS系统获得控制场内的以VSTARS系统坐标系下的靶标板33*16（一块板上两张靶标纸）共计528个点坐标。载入文件名：bundle4.txt
2.	前期使用影像仪获取的单块靶标上光敏元件中心和其余16个V-STARS反光标记点共计17个点的坐标。载入文件名：n.txt，共计33个txt文件。

主程序输出：
1.	33个靶标上的光敏元件中心在V-STARS坐标系下的坐标
2.	33个基准点的均方根误差

主程序简述：
一：数据处理
1.	采用字符串比较获取bundle行名（rowheader）中的以‘CODE’、‘NUGGET’开头相同的字符的行数；
2.	利用行数操作对应每块靶标的7个‘NUGGET’点，1个‘CODE’点的行数放置在一个向量中，66张靶标成为一个66*8的矩阵；
3.	利用矩阵赋值操作将7个‘NUGGET’点，1个‘CODE’点的行数转化成字符串放置在新的66*8矩阵中；
4.	前期根据规律找到V-STARS的点名命名规则，使用这一规则将上步获得的字符串数组进行比对，有顺序的将数组扩展成一个正确顺序的66*9矩阵（含1）
5.	去除1，重新将矩阵变化为66*8矩阵
6.	将矩阵截取排序成33*16的矩阵，与影像仪数据格式匹配。

二：坐标转换
使用for循环：在循环体中每次循环获取1个板子的影像仪坐标文件，并与数据处理中第6步获得的矩阵作为函数findRT的输入，输出点坐标和对应的均方根误差

三：输出基准点文件
	因为后续再内参标定软件中需要导入基准点文件格式是txt，所以采用文件读写操作写出两个txt文件，命名为‘Coord_Receiver.txt’和‘Error_rms.txt’
自编函数：findRT
函数输入：
1.	某块靶标上的反光标记点在V-STARS系统下坐标；
2.	某块靶标上反光标记点和光敏元件中心在影像仪坐标系下的坐标。

函数输出：
某块靶标的光敏元件中心在V-STARS系统下坐标
某块靶标的光敏元件中心坐标的均方根误差
 
